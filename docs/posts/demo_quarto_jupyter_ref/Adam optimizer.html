<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alex Kelly">
<meta name="dcterms.date" content="2023-12-28">

<title>Alex Paul Kelly - Adam optimizer with annealing learning rate</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Alex Paul Kelly</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/resolver101757" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/alex_paul_kelly" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/alexpkelly/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Adam optimizer with annealing learning rate</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Alex Kelly </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 28, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a>
  <ul class="collapse">
  <li><a href="#what-is-a-optimizer-in-deep-learning-and-why-it-is-important" id="toc-what-is-a-optimizer-in-deep-learning-and-why-it-is-important" class="nav-link" data-scroll-target="#what-is-a-optimizer-in-deep-learning-and-why-it-is-important">What is a optimizer in deep learning and why it is important?</a></li>
  <li><a href="#adam-optimizer-with-annealing-learning-rate" id="toc-adam-optimizer-with-annealing-learning-rate" class="nav-link" data-scroll-target="#adam-optimizer-with-annealing-learning-rate">Adam optimizer with annealing learning rate</a></li>
  </ul></li>
  <li><a href="#setup-enviroment" id="toc-setup-enviroment" class="nav-link" data-scroll-target="#setup-enviroment">Setup enviroment</a></li>
  <li><a href="#get-the-data" id="toc-get-the-data" class="nav-link" data-scroll-target="#get-the-data">Get the data</a></li>
  <li><a href="#setup-the-call-backs" id="toc-setup-the-call-backs" class="nav-link" data-scroll-target="#setup-the-call-backs">Setup the call backs</a></li>
  <li><a href="#the-mini-ai-learner-class-and-how-the-optimizer-runs" id="toc-the-mini-ai-learner-class-and-how-the-optimizer-runs" class="nav-link" data-scroll-target="#the-mini-ai-learner-class-and-how-the-optimizer-runs">The mini AI learner class and how the optimizer runs</a></li>
  <li><a href="#the-optimizers-overview" id="toc-the-optimizers-overview" class="nav-link" data-scroll-target="#the-optimizers-overview">The optimizers overview</a>
  <ul class="collapse">
  <li><a href="#the-sgd-optimizer" id="toc-the-sgd-optimizer" class="nav-link" data-scroll-target="#the-sgd-optimizer">The SGD optimizer</a></li>
  <li><a href="#adam" id="toc-adam" class="nav-link" data-scroll-target="#adam">Adam</a></li>
  </ul></li>
  <li><a href="#adam-with-automatic-annealer" id="toc-adam-with-automatic-annealer" class="nav-link" data-scroll-target="#adam-with-automatic-annealer">Adam with Automatic Annealer</a></li>
  <li><a href="#the-calls-backs" id="toc-the-calls-backs" class="nav-link" data-scroll-target="#the-calls-backs">The Calls backs</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="overview" class="level1">
<h1>Overview</h1>
<p>A neural network is a machine learning model that is inspired by the human brain. A human brain is collection of neurons that are connected to each other by synapses and electrical pulses travel between. This consist of a input, say reading a book and the neural network will respond by firing up the relevent neruanons that deal reading text and makes sense of the text (the thinking process) and giving a output, e.g.&nbsp;giving a sumarry of the text read. An artificial neural network (ann) is a collection of artificial neurons that are connected to each other in a particular archtechure that exists on a computer. A example ANN arcitecture could be a CNN (converlutiohn neural network) or a RNN (Recurrent Neural Network ) or a combination of these layers and many others. In the notebooks case, the model will take in a sequences of pixels (an image) and output a sequence of pixels (an image) using sequential CNNs.</p>
<div class="cell" data-executioninfo="{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1704458412294,&quot;user_tz&quot;:0,&quot;elapsed&quot;:207,&quot;user&quot;:{&quot;displayName&quot;:&quot;alex kelly&quot;,&quot;userId&quot;:&quot;14681700393893986055&quot;}}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># !["Human neural network vs artificial neural network"]("https://clevertap.com/wp-content/uploads/2019/04/Neural_Network_Brain_Mimic.jpeg")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The archtechure of the model is a type of convolutional neural network (CNN) and it consists of five main blocks, each containing a sequence of layers.</p>
<ol type="1">
<li>The first block starts with a Conv2d layer with 1 input channel and 8 output channels, followed by a BatchNorm2d layer and a GeneralRelu (generalized ReLU) activation function.</li>
<li>The second block is similar to the first, but it starts with a Conv2d layer with 8 input channels and 16 output channels.</li>
<li>The third block starts with a Conv2d layer with 16 input channels and 32 output channels, followed by the same sequence of BatchNorm2d and GeneralRelu layers.</li>
<li>The fourth block starts with a Conv2d layer with 32 input channels and 64 output channels, followed by the same sequence of BatchNorm2d and GeneralRelu layers.</li>
<li>The fifth block contains only a Conv2d layer with 64 input channels and 10 output channels.</li>
</ol>
<p>Finally, the model includes a Flatten layer to convert the 2D output of the previous layers into a 1D vector for further processing or output.</p>
<p>The the convolutions help compress the image into a smaller and smaller sizes and the model can learn the important features of the image. The model on the last layer will then use the features to make a prediction.</p>
<section id="what-is-a-optimizer-in-deep-learning-and-why-it-is-important" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-optimizer-in-deep-learning-and-why-it-is-important">What is a optimizer in deep learning and why it is important?</h2>
<p>An optimizer is a method to update the weights of the neural network to minimize the loss function. A loss function is a measure between the predicted output and the actual output. In simple terms the closer these two are the better the model will perform, you will get what you expect from the model. The weights are updated by using the gradient of the loss function. The gradient is the slope of the loss function. It can be thought of as the direction the weights should be updated. If the gradient is positive then the weights should be increased. If the gradient is negative then the weights should be decreased. If the weights are increased/descreased by too much then the model will over shoot and not get you closer to the actual output you want. The aim of the optimizer is to get to the smallest loss possible in the quickest amount of time or with the least amount of processing power.</p>
</section>
<section id="adam-optimizer-with-annealing-learning-rate" class="level2">
<h2 class="anchored" data-anchor-id="adam-optimizer-with-annealing-learning-rate">Adam optimizer with annealing learning rate</h2>
<p>The aim of this blog is to show how to use the Adam optimizer with annealing learning rate. The Adam optimizer is a stochastic gradient descent method that is based on adaptive estimation of first-order and second-order moments. The Adam optimizer is one of the most popular optimizers used in deep learning. The annealing learning rate is used to prevent the model from overfitting and is also used to speed up the training process.</p>
</section>
</section>
<section id="setup-enviroment" class="level1">
<h1>Setup enviroment</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checks if the environment is local or remote</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> check_if_local():</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Checking for common remote environment indicators</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    remote_indicators <span class="op">=</span> [<span class="st">'COLAB_GPU'</span>, <span class="st">'JUPYTERHUB_SERVICE_PREFIX'</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If any of the indicators are present, it's likely not a local environment</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">any</span>(indicator <span class="kw">in</span> os.environ <span class="cf">for</span> indicator <span class="kw">in</span> remote_indicators):</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Assuming local environment if none of the remote indicators are found</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:14728,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1704295560392,&quot;user&quot;:{&quot;displayName&quot;:&quot;alex kelly&quot;,&quot;userId&quot;:&quot;14681700393893986055&quot;},&quot;user_tz&quot;:0}" data-outputid="85b90c90-4af5-44af-f6c7-4e66fd233d5d">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># checks if the environment is local or remote and sets the path accordingly</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> check_if_local() <span class="op">==</span> <span class="va">False</span>:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Running in a remote environment, mounting Google Drive...'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    drive.mount(<span class="st">'/content/drive'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    sys.path.append(<span class="st">'/content/drive/MyDrive/Learning/data_science/'</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install datasets</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">!</span>pip install torcheval</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span> :</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Running in a local environment...'</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    sys.path.append(<span class="st">'G:\My Drive\Learning\data_science'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running in a remote environment, mounting Google Drive...
Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount("/content/drive", force_remount=True).
Requirement already satisfied: datasets in /usr/local/lib/python3.10/dist-packages (2.16.1)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from datasets) (3.13.1)
Requirement already satisfied: numpy&gt;=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.23.5)
Requirement already satisfied: pyarrow&gt;=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (10.0.1)
Requirement already satisfied: pyarrow-hotfix in /usr/local/lib/python3.10/dist-packages (from datasets) (0.6)
Requirement already satisfied: dill&lt;0.3.8,&gt;=0.3.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.3.7)
Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)
Requirement already satisfied: requests&gt;=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.31.0)
Requirement already satisfied: tqdm&gt;=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.66.1)
Requirement already satisfied: xxhash in /usr/local/lib/python3.10/dist-packages (from datasets) (3.4.1)
Requirement already satisfied: multiprocess in /usr/local/lib/python3.10/dist-packages (from datasets) (0.70.15)
Requirement already satisfied: fsspec[http]&lt;=2023.10.0,&gt;=2023.1.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.6.0)
Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets) (3.9.1)
Requirement already satisfied: huggingface-hub&gt;=0.19.4 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.20.1)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.2)
Requirement already satisfied: pyyaml&gt;=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0.1)
Requirement already satisfied: attrs&gt;=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp-&gt;datasets) (23.1.0)
Requirement already satisfied: multidict&lt;7.0,&gt;=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp-&gt;datasets) (6.0.4)
Requirement already satisfied: yarl&lt;2.0,&gt;=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp-&gt;datasets) (1.9.4)
Requirement already satisfied: frozenlist&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp-&gt;datasets) (1.4.1)
Requirement already satisfied: aiosignal&gt;=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp-&gt;datasets) (1.3.1)
Requirement already satisfied: async-timeout&lt;5.0,&gt;=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp-&gt;datasets) (4.0.3)
Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub&gt;=0.19.4-&gt;datasets) (4.5.0)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.19.0-&gt;datasets) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.19.0-&gt;datasets) (3.6)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.19.0-&gt;datasets) (2.0.7)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.19.0-&gt;datasets) (2023.11.17)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas-&gt;datasets) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas-&gt;datasets) (2023.3.post1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.1-&gt;pandas-&gt;datasets) (1.16.0)
Collecting torcheval
  Downloading torcheval-0.0.7-py3-none-any.whl (179 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 179.2/179.2 kB 3.6 MB/s eta 0:00:00
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from torcheval) (4.5.0)
Installing collected packages: torcheval
Successfully installed torcheval-0.0.7</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:1704466309123,&quot;user_tz&quot;:0,&quot;elapsed&quot;:7407,&quot;user&quot;:{&quot;displayName&quot;:&quot;alex kelly&quot;,&quot;userId&quot;:&quot;14681700393893986055&quot;}}" data-outputid="c4b45797-f8be-4c69-bf26-8692bd1d986d" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle,gzip,math,os,time,shutil,torch,matplotlib <span class="im">as</span> mpl,numpy <span class="im">as</span> np,matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fastcore.<span class="bu">all</span> <span class="im">as</span> fc</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections.abc <span class="im">import</span> Mapping</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> operator <span class="im">import</span> attrgetter,itemgetter</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> partial</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> contextlib <span class="im">import</span> contextmanager</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torchvision.transforms.functional <span class="im">as</span> TF,torch.nn.functional <span class="im">as</span> F</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch <span class="im">import</span> tensor,nn,optim</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.data <span class="im">import</span> DataLoader,default_collate</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.nn <span class="im">import</span> init</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.optim <span class="im">import</span> lr_scheduler</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torcheval.metrics <span class="im">import</span> MulticlassAccuracy</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datasets <span class="im">import</span> load_dataset,load_dataset_builder</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> miniai.datasets <span class="im">import</span> <span class="op">*</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> miniai.conv <span class="im">import</span> <span class="op">*</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> miniai.learner <span class="im">import</span> <span class="op">*</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> miniai.activations <span class="im">import</span> <span class="op">*</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> miniai.init <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ModuleNotFoundError: ignored</code></pre>
</div>
</div>
</section>
<section id="get-the-data" class="level1">
<h1>Get the data</h1>
<div class="cell" data-executioninfo="{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1704295633651,&quot;user_tz&quot;:0,&quot;elapsed&quot;:54107,&quot;user&quot;:{&quot;displayName&quot;:&quot;alex kelly&quot;,&quot;userId&quot;:&quot;14681700393893986055&quot;}}" data-outputid="df23f4ed-3a4b-4850-f768-b3476ad8c10d">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastcore.test <span class="im">import</span> test_close</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>torch.set_printoptions(precision<span class="op">=</span><span class="dv">2</span>, linewidth<span class="op">=</span><span class="dv">140</span>, sci_mode<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> logging</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>logging.disable(logging.WARNING)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>set_seed(<span class="dv">42</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>xl,yl <span class="op">=</span> <span class="st">'image'</span>,<span class="st">'label'</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>name <span class="op">=</span> <span class="st">"fashion_mnist"</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>dsd <span class="op">=</span> load_dataset(name)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>bs <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>xmean,xstd <span class="op">=</span> <span class="fl">0.28</span>, <span class="fl">0.35</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="at">@inplace</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transformi(b): b[xl] <span class="op">=</span> [(TF.to_tensor(o)<span class="op">-</span>xmean)<span class="op">/</span>xstd <span class="cf">for</span> o <span class="kw">in</span> b[xl]]</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>tds <span class="op">=</span> dsd.with_transform(transformi)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> DataLoaders.from_dd(tds, bs, num_workers<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:72: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:72: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(</code></pre>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"76edd4ce9e8c4dbf816f5ad5562a93d0","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"d735656a7a394c939c199b9f5b251081","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"f52b048abd99419b92214941f55798bd","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major":2,"version_minor":0,"model_id":"08b7c8dd16fa4d669d72a8867eb63f27","quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
</section>
<section id="setup-the-call-backs" class="level1">
<h1>Setup the call backs</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> MetricsCB(accuracy<span class="op">=</span>MulticlassAccuracy())</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>astats <span class="op">=</span> ActivationStats(fc.risinstance(GeneralRelu))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>cbs <span class="op">=</span> [DeviceCB(), metrics, ProgressCB(plot<span class="op">=</span><span class="va">True</span>), astats]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>act_gr <span class="op">=</span> partial(GeneralRelu, leak<span class="op">=</span><span class="fl">0.1</span>, sub<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>iw <span class="op">=</span> partial(init_weights, leaky<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>lrf_cbs <span class="op">=</span> [DeviceCB(), LRFinderCB()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-mini-ai-learner-class-and-how-the-optimizer-runs" class="level1">
<h1>The mini AI learner class and how the optimizer runs</h1>
<p>We are using the MiniAI custom trainer class. It enables you to train deep learning models, in our case pytorch models. Its very dynanamic and enables you to add callbacks (custom peices of code) to various parts of the training process. This creates a flexible system where you can add, swap and experiment in a quick, easy and repeatably way. In summary its very flexiable trainer class.</p>
<p>The mini AI learner class takes in the model, the data, the optimizer class (how to minimize the loss), the loss function (how to calculate the loss), the number of epochs (how many times to train the model on the data), the learning rate and any call backs. For the next few trainings runs we will use a varient of the learner class called TrainLeaner, the only difference between learner and trainlearner is it explicitly adds the following functions rather than passing them as callbacks.</p>
<ol type="1">
<li>predict</li>
<li>get_loss</li>
<li>backward</li>
<li>step</li>
<li>zero_grad</li>
</ol>
<p>The first step is to create an instance of the TrainLearner class and next step is to call the fit method to start the training. In summary it will:</p>
<ol type="1">
<li>Pass the first batch of data to the model</li>
<li>Calculate the loss on the model</li>
<li>Perform back propergation to figure out the gradient</li>
<li>Run the opimizer (e.g.&nbsp;SGD or ADAM) to figure out how to reduce the loss in the most optimized way</li>
<li>Zero’s the gradients for all the parameters (Most models accumilates the gradients so zero’ing is important to get the correct result)</li>
<li>Repeat 1 to 5 until until you’ve been through the data as many times as specified in the epochs parameter in the hope that the model has learned the features of the data and can give a good prediction.</li>
</ol>
<p>A more detailed diagram of the learner method when fit is called is shown below.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart TD
    A(fit called) --&gt; B[fit]
    B --&gt;|Set epochs, opt func, etc.| C[_fit]
    C --&gt;|For each epoch| D[one_epoch for Training]
    C --&gt;|For each epoch| E[one_epoch for Validation]
    D --&gt; F{_one_batch for each batch in Training}
    E --&gt; G{_one_batch for each batch in Validation}
    F --&gt; H[predict]
    G --&gt; H
    H --&gt; I[get_loss]
    I --&gt;|If Training| J[backward]
    I --&gt;|If Validation| K(End of batch processing)
    J --&gt; L[step]
    L --&gt; M[zero_grad]
    M --&gt; K

    subgraph SGD Optimizer
        L --&gt;|opt_step| N(Update params with lr and gradient)
        L --&gt;|reg_step| O(Update params with weight decay)
        M --&gt; P(Reset gradients)
    end

    subgraph TrainLearner Methods
        H --&gt; Q(Predict: Model forward pass)
        I --&gt; R(Calculate Loss)
        J --&gt; S(Backward: Compute gradient)
        L --&gt; T(Step: Update weights)
        M --&gt; U(Zero_grad: Clear gradients)
    end
</pre>
</div>
</div>
</div>
</div>
<p>The diagram below shows a higher level view of the class diagram of the learner module and the optimizer module.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The learner class expects the following fucntions to be passed as a callback : predict, get_loss, backward, step, zero_grad.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Learner():</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model, dls<span class="op">=</span>(<span class="dv">0</span>,), loss_func<span class="op">=</span>F.mse_loss, lr<span class="op">=</span><span class="fl">0.1</span>, cbs<span class="op">=</span><span class="va">None</span>, opt_func<span class="op">=</span>optim.SGD):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        cbs <span class="op">=</span> fc.L(cbs)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        fc.store_attr()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">@with_cbs</span>(<span class="st">'batch'</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _one_batch(<span class="va">self</span>):</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.predict()</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.callback(<span class="st">'after_predict'</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.get_loss()</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.callback(<span class="st">'after_loss'</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.training:</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.backward()</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.callback(<span class="st">'after_backward'</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.step()</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.callback(<span class="st">'after_step'</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.zero_grad()</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">@with_cbs</span>(<span class="st">'epoch'</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _one_epoch(<span class="va">self</span>):</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="va">self</span>.<span class="bu">iter</span>,<span class="va">self</span>.batch <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="va">self</span>.dl): <span class="va">self</span>._one_batch()</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> one_epoch(<span class="va">self</span>, training):</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.model.train(training)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.dl <span class="op">=</span> <span class="va">self</span>.dls.train <span class="cf">if</span> training <span class="cf">else</span> <span class="va">self</span>.dls.valid</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>._one_epoch()</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">@with_cbs</span>(<span class="st">'fit'</span>)</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _fit(<span class="va">self</span>, train, valid):</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="va">self</span>.epoch <span class="kw">in</span> <span class="va">self</span>.epochs:</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> train: <span class="va">self</span>.one_epoch(<span class="va">True</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid: torch.no_grad()(<span class="va">self</span>.one_epoch)(<span class="va">False</span>)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> fit(<span class="va">self</span>, n_epochs<span class="op">=</span><span class="dv">1</span>, train<span class="op">=</span><span class="va">True</span>, valid<span class="op">=</span><span class="va">True</span>, cbs<span class="op">=</span><span class="va">None</span>, lr<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        cbs <span class="op">=</span> fc.L(cbs)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># `add_cb` and `rm_cb` were added in lesson 18</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> cb <span class="kw">in</span> cbs: <span class="va">self</span>.cbs.append(cb)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.n_epochs <span class="op">=</span> n_epochs</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.epochs <span class="op">=</span> <span class="bu">range</span>(n_epochs)</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> lr <span class="kw">is</span> <span class="va">None</span>: lr <span class="op">=</span> <span class="va">self</span>.lr</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="va">self</span>.opt_func: <span class="va">self</span>.opt <span class="op">=</span> <span class="va">self</span>.opt_func(<span class="va">self</span>.model.parameters(), lr)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>._fit(train, valid)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span>:</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> cb <span class="kw">in</span> cbs: <span class="va">self</span>.cbs.remove(cb)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__getattr__</span>(<span class="va">self</span>, name):</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> name <span class="kw">in</span> (<span class="st">'predict'</span>,<span class="st">'get_loss'</span>,<span class="st">'backward'</span>,<span class="st">'step'</span>,<span class="st">'zero_grad'</span>): <span class="cf">return</span> partial(<span class="va">self</span>.callback, name)</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">AttributeError</span>(name)</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> callback(<span class="va">self</span>, method_nm): run_cbs(<span class="va">self</span>.cbs, method_nm, <span class="va">self</span>)</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">@property</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> training(<span class="va">self</span>): <span class="cf">return</span> <span class="va">self</span>.model.training</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The Trainer class inherits all the classes from Leaner but explicitly adds</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># predict, get_loss, backward, step, zero_grad classes functions</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> TrainLearner(Learner):</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> predict(<span class="va">self</span>): <span class="va">self</span>.preds <span class="op">=</span> <span class="va">self</span>.model(<span class="va">self</span>.batch[<span class="dv">0</span>])</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> get_loss(<span class="va">self</span>): <span class="va">self</span>.loss <span class="op">=</span> <span class="va">self</span>.loss_func(<span class="va">self</span>.preds, <span class="va">self</span>.batch[<span class="dv">1</span>])</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> backward(<span class="va">self</span>): <span class="va">self</span>.loss.backward()</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>): <span class="va">self</span>.opt.step()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> zero_grad(<span class="va">self</span>): <span class="va">self</span>.opt.zero_grad()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-optimizers-overview" class="level1">
<h1>The optimizers overview</h1>
<p>We will start of with one of the simplest optimizers and build up, taking in the results and how they improve as we introduce more affective optimisers. We will cover SGD, Adam, Adam with Automatic Annealer, and then introduce Adam with Automatic Annealing as a call back. Abit about each of the optimizers:</p>
<ul>
<li><p><strong>SGD</strong> is a simple optimizer that takes in the learning rate and the model parameters and updates the model parameters by subtracting the learning rate multiplied by the gradient of the loss function. The learning rate is a hyperparameter that needs to be tuned to get the best results. If the learning rate is too high then the model will overshoot and not get to the minimum loss. If the learning rate is too low then the model will take a long time to get to the minimum loss. The learning rate is a constant and does not change during the training process.</p></li>
<li><p><strong>Adam</strong> is a stochastic gradient descent method that is based on adaptive estimation of first-order and second-order moments. It is one of the most popular optimizers used in deep learning. It is a adaptive learning rate optimizer that uses the first and second moments of the gradient to update the model parameters. The first moment is the mean of the gradient and the second moment is the uncentered variance of the gradient. The first moment is used to calculate the direction of the gradient and the second moment is used to calculate the size of the gradient. The Adam optimizer has three hyperparameters that need to be tuned to get the best results. The first hyperparameter is the learning rate. The second hyperparameter is the beta1 which is the exponential decay rate for the first moment. The third hyperparameter is the beta2 which is the exponential decay rate for the second moment. The learning rate is a constant and does not change during the training process. The beta1 and beta2 are constants and do not change during the training process.</p></li>
<li><p><strong>Adam with Automatic Annealing</strong> is a Adam optimizer that uses a learning rate that changes during the training process. The learning rate is a hyperparameter that needs to be tuned to get the best results. If the learning rate is too high then the model will overshoot and not get to the minimum loss. If the learning rate is too low then the model will take a long time to get to the minimum loss. The learning rate is a constant and does not change during the training process.</p></li>
</ul>
<section id="the-sgd-optimizer" class="level2">
<h2 class="anchored" data-anchor-id="the-sgd-optimizer">The SGD optimizer</h2>
<p>The SGD optimizer class is a simple class that takes in params, learning rate (lr), and weight decay. It has 4 functions step, opt_step, reg_step and zero_grad. The key function relating to TrainLearner is the step function which calls opt_step (updates the parameters from the learning rate) and reg_step (updates parameters from the weight decay if given).</p>
<p>Zero_grad is called after every batch to zero the gradients, by default in pytorch they acculmtate which isnt desired.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SGD optimizer is a type of gradient descent optimizer.  It is a first order optimizer (only uses the first derivative)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It is a stochastic optimizer (it uses a random sample of the data to calculate the gradient)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SGD:</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, params, lr, wd<span class="op">=</span><span class="fl">0.</span>):</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">        Initializes the SGD  optimizer.</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">            params (iterable): Iterable of parameters to optimize.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">            lr (float): Learning rate.</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">            wd (float, optional): Weight decay (default: 0).</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        params <span class="op">=</span> <span class="bu">list</span>(params)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>        fc.store_attr()</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculates the parameters and weight decays. Step occurs after the backward pass (when the gradients are calculated)</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>):</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calls torch.no_grad() to disable gradient tracking</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>            <span class="co"># iterates over the parameters</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> p <span class="kw">in</span> <span class="va">self</span>.params:</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.reg_step(p)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.opt_step(p)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.i <span class="op">+=</span><span class="dv">1</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Updates the parameters using the gradient and the learning rate</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> opt_step(<span class="va">self</span>, p): p <span class="op">-=</span> p.grad <span class="op">*</span> <span class="va">self</span>.lr</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculates the weight decay and updates the parameters</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The purpose of weight decay is to prevent overfitting. It is calculated by multiplying the learning rate by the weight decay</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># essentially it is a penalty for having large weights (it reduces the value of the weights)</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reg_step(<span class="va">self</span>, p):</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.wd <span class="op">!=</span> <span class="dv">0</span>: p <span class="op">*=</span> <span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.lr<span class="op">*</span><span class="va">self</span>.wd</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Zeros out the gradient for all parameters.  This is useful because the gradients are accumulated by default (useful for RNNs)</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> zero_grad(<span class="va">self</span>):</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> p <span class="kw">in</span> <span class="va">self</span>.params: p.grad.data.zero_()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1704295854227,&quot;user_tz&quot;:0,&quot;elapsed&quot;:106719,&quot;user&quot;:{&quot;displayName&quot;:&quot;alex kelly&quot;,&quot;userId&quot;:&quot;14681700393893986055&quot;}}" data-outputid="d81ed421-44e0-4958-c3ce-3fa00240ee86">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>set_seed(<span class="dv">42</span>)                                             <span class="co"># sets the seed for reproducibility</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> get_model(act_gr, norm<span class="op">=</span>nn.BatchNorm2d).<span class="bu">apply</span>(iw) <span class="co"># gets the model and applies the init_weights function</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># creates the learner object and passes the model, dataloaders (the data), loss function, learning rate,</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># callbacks and optimizer function</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> TrainLearner(model, dls, F.cross_entropy, lr<span class="op">=</span><span class="fl">6e-3</span>, cbs<span class="op">=</span>cbs, opt_func<span class="op">=</span>SGD)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>learn.fit(<span class="dv">3</span>)                                             <span class="co"># fits the model for 3 epochs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">loss</th>
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.396</td>
<td>1.808</td>
<td>0</td>
<td>train</td>
</tr>
<tr class="even">
<td>0.558</td>
<td>1.467</td>
<td>0</td>
<td>eval</td>
</tr>
<tr class="odd">
<td>0.611</td>
<td>1.304</td>
<td>1</td>
<td>train</td>
</tr>
<tr class="even">
<td>0.644</td>
<td>1.179</td>
<td>1</td>
<td>eval</td>
</tr>
<tr class="odd">
<td>0.672</td>
<td>1.093</td>
<td>2</td>
<td>train</td>
</tr>
<tr class="even">
<td>0.688</td>
<td>1.029</td>
<td>2</td>
<td>eval</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<p><img src="Adam optimizer_files/figure-html/cell-12-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="adam" class="level2">
<h2 class="anchored" data-anchor-id="adam">Adam</h2>
<p>Adam optimizer (also known as Adaptive Moment Estimation)is a stochastic gradient descent method that is based on adaptive estimation of first-order and second-order moments. It’s a combination of RMSprop and Momentum and commonly used in deep learning. It’s a little more complex than the SGD discussed above. There are some learning utilities and also numbered code explanations to help understand the code further.</p>
<p>for a deeper dive deaper, the following resources are good references.</p>
<ul>
<li>https://www.mathsisfun.com/calculus/second-derivative.html</li>
<li>https://www.mathsisfun.com/calculus/second-derivative-animation.html</li>
</ul>
<p>The Adam optimizer inherits all the code from SGD and replaces opt_step with new code to update the gradients. The important variables it takes in for our case are :</p>
<ul>
<li>params (also known as p in opt_step) also known as the weights and bias’s</li>
<li>Beta1 which really should be called something like “momentum_decay_rate”, it is akin to momentum in physics and helps to accelerate the optimizer in the direction of consistent and persistent gradients over time.</li>
<li>Beta2 which should really be called something like “variance_decay_rate”. It is used for adaptive learning rate purposes, helping to adjust the learning rate based on the variability of the gradients</li>
</ul>
<p>A way i like to visualize beta1 (“momentum_decay_rate”) and beta2 (“variance_decay_rate”) is beta1 is the compass and beta2 is the distance to travel.</p>
<div class="cell" data-executioninfo="{&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:1704461342283,&quot;user_tz&quot;:0,&quot;elapsed&quot;:190,&quot;user&quot;:{&quot;displayName&quot;:&quot;alex kelly&quot;,&quot;userId&quot;:&quot;14681700393893986055&quot;}}" data-outputid="9b81b0d2-fad5-4f94-ebca-15fbbe2efb41" data-execution_count="5">
<div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode python code-annotation-code code-with-copy code-annotated"><code class="sourceCode python"><span id="annotated-cell-12-1"><a href="#annotated-cell-12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Adam(SGD):</span>
<span id="annotated-cell-12-2"><a href="#annotated-cell-12-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, params, lr, wd<span class="op">=</span><span class="fl">0.</span>, beta1<span class="op">=</span><span class="fl">0.9</span>, beta2<span class="op">=</span><span class="fl">0.99</span>, eps<span class="op">=</span><span class="fl">1e-5</span>):</span>
<span id="annotated-cell-12-3"><a href="#annotated-cell-12-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(params, lr<span class="op">=</span>lr, wd<span class="op">=</span>wd)</span>
<span id="annotated-cell-12-4"><a href="#annotated-cell-12-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.beta1,<span class="va">self</span>.beta2,<span class="va">self</span>.eps <span class="op">=</span> beta1,beta2,eps</span>
<span id="annotated-cell-12-5"><a href="#annotated-cell-12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-12-6"><a href="#annotated-cell-12-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> opt_step(<span class="va">self</span>, p):</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-12-7" class="code-annotation-target"><a href="#annotated-cell-12-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(p, <span class="st">'avg'</span>): p.avg <span class="op">=</span> torch.zeros_like(p.grad.data)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-12-8" class="code-annotation-target"><a href="#annotated-cell-12-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(p, <span class="st">'sqr_avg'</span>): p.sqr_avg <span class="op">=</span> torch.zeros_like(p.grad.data)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-12-9" class="code-annotation-target"><a href="#annotated-cell-12-9" aria-hidden="true" tabindex="-1"></a>        p.avg <span class="op">=</span> <span class="va">self</span>.beta1<span class="op">*</span>p.avg <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span><span class="va">self</span>.beta1)<span class="op">*</span>p.grad</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-12-10" class="code-annotation-target"><a href="#annotated-cell-12-10" aria-hidden="true" tabindex="-1"></a>        unbias_avg <span class="op">=</span> p.avg <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="va">self</span>.beta1<span class="op">**</span>(<span class="va">self</span>.i<span class="op">+</span><span class="dv">1</span>)))</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-12-11" class="code-annotation-target"><a href="#annotated-cell-12-11" aria-hidden="true" tabindex="-1"></a>        p.sqr_avg <span class="op">=</span> <span class="va">self</span>.beta2<span class="op">*</span>p.sqr_avg <span class="op">+</span> (<span class="dv">1</span><span class="op">-</span><span class="va">self</span>.beta2)<span class="op">*</span>(p.grad<span class="op">**</span><span class="dv">2</span>)</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-12-12" class="code-annotation-target"><a href="#annotated-cell-12-12" aria-hidden="true" tabindex="-1"></a>        unbias_sqr_avg <span class="op">=</span> p.sqr_avg <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="va">self</span>.beta2<span class="op">**</span>(<span class="va">self</span>.i<span class="op">+</span><span class="dv">1</span>)))</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="7" onclick="event.preventDefault();">7</a><span id="annotated-cell-12-13" class="code-annotation-target"><a href="#annotated-cell-12-13" aria-hidden="true" tabindex="-1"></a>        p <span class="op">-=</span> <span class="va">self</span>.lr <span class="op">*</span> unbias_avg <span class="op">/</span> (unbias_sqr_avg <span class="op">+</span> <span class="va">self</span>.eps).sqrt()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-annotation="1" data-code-lines="7">Checks avg tensor doesnt exist in p, if doesnt existit creates a matching size tensor of all parameters to store averages, they will all be zeros.</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-annotation="2" data-code-lines="8">Checks sqr_avg doesnt exist in p, if it doesnt exist it creates a matching sized tensor of all parameters to store sqr averages, they will all be zeros.</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-annotation="3" data-code-lines="9">p.avg is to store the averages, it can be thought of as a balance between the old gradients and the new gradiants<br> Beta is set between 1 or 0, when its closer to 1 it takes more of the historical gradients into account and when close to 0, it takes more of the new gradients into account.<br> When its closer to 1, it will be a smoother path and when its zero it will respond to changes in gradients much quicker and appear more erratic.<br> Note, on the first run the calculation of p.avg is solely based on the latter part of the equation “(1 - self.beta1) * p.grad”.<br> The first part of the equation “self.beta1 * p.avg” is zero meaning due to p.avg being set to zeros in the line “p.avg = torch.zeros_like(p.grad.data)”.<br> The next time opt_step is called, The first part of the equation will influence the result “self.beta1 * p.avg”.<br></span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-annotation="4" data-code-lines="10">Unbias_avg purpose is to correct p.avg for the earier few times called when p.avg is initialised as zero as described in point 1. Something is required to reduce the depency on p.avg during the early calls, this is where unbias comes into play and will be more significant for the early iterations and gradually becomes less significant for later iterations.</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-annotation="5" data-code-lines="11">Squaring the gradients (p.grad**2) emphasizes larger gradients and diminishes the impact of smaller ones. We dont want this but will become clearer on point 7.</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-annotation="6" data-code-lines="12">unbias_sqr_avg purpose is to correct p.sqr_avg for the first few times called. Remember that in the previous step, the p.sqr_avg is zero so isnt included in the calculations.<br> The unbias will is more significant for the early iterations and gradually becomes less significant for later iterations.</span>
</dd>
<dt data-target-cell="annotated-cell-12" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-annotation="7" data-code-lines="13">The final peice is to update the parameters (weights and bias’s). The second part of the equation is to “(unbias_sqr_avg + self.eps).sqrt()” is to get the distance (the 2nd momentum), unbias_sqr_avg will lead to overshooting so square root the value to get a smoother line. The 1st part of equation is 1st moment (the direction of travel) and its to get at the average direction of the travel taking into a account the learning rate, following on from the anology of the compass, this means the more epoch’s (one pass through the dat) through the data, the less the direction changes.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-error">
<pre><code>NameError: ignored</code></pre>
</div>
</div>
<p>The aim of the graph below was to dispict of how gradients (marked in red) can jump up and down over time over epoch (note this is mock data but illistrates the issue found when trying to minimize the loss <br> The left chart shows how squaring (Green) the results increases the magnitude positivly<br> The chart on the right shows how smooth the line looks when square rooting (blue) the previously squared values.<br></p>
<p>This shows how a slow and steady path (line in this case) to minimize the loss is key to getting to a loss function of meaning.</p>
<div class="cell" data-executioninfo="{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1704466802970,&quot;user_tz&quot;:0,&quot;elapsed&quot;:1152,&quot;user&quot;:{&quot;displayName&quot;:&quot;alex kelly&quot;,&quot;userId&quot;:&quot;14681700393893986055&quot;}}" data-outputid="116b072f-5489-40b8-e127-d7a7f747d68a" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate some gradients</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>gradients <span class="op">=</span> np.random.randn(<span class="dv">100</span>)  <span class="co"># Random gradients for simulation</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute squared gradients</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>squared_gradients <span class="op">=</span> gradients<span class="op">**</span><span class="dv">2</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute square root of the average of squared gradients (simulating the second moment in Adam)</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>sqrt_avg_squared_gradients <span class="op">=</span> np.sqrt(np.cumsum(squared_gradients) <span class="op">/</span> np.arange(<span class="dv">1</span>, <span class="dv">101</span>))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Updating the plot with distinct colors for each curve</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting with distinct colors</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for Gradients and Squared Gradients</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>plt.plot(gradients, label<span class="op">=</span><span class="st">'Gradients'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>plt.plot(squared_gradients, label<span class="op">=</span><span class="st">'Squared Gradients'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gradients and Squared Gradients'</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time Steps'</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Magnitude'</span>)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot for Gradients and Square Root of Avg of Squared Gradients</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>plt.plot(gradients, label<span class="op">=</span><span class="st">'Gradients'</span>, color<span class="op">=</span><span class="st">'blue'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>plt.plot(sqrt_avg_squared_gradients, label<span class="op">=</span><span class="st">'Sqrt of Avg of Squared Gradients'</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Gradients and Sqrt of Avg of Squared Gradients Over Time'</span>)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Time Steps'</span>)</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Magnitude'</span>)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 1200x600 with 0 Axes&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Adam optimizer_files/figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1704297650160,&quot;user_tz&quot;:0,&quot;elapsed&quot;:103190,&quot;user&quot;:{&quot;displayName&quot;:&quot;alex kelly&quot;,&quot;userId&quot;:&quot;14681700393893986055&quot;}}" data-outputid="875cc6eb-b13b-422f-d851-ab58dbbcff8f">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first run with adam as the optimizer</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>set_seed(<span class="dv">42</span>)                                                <span class="co"># sets the seed for reproducibility</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> get_model(act_gr, norm<span class="op">=</span>nn.BatchNorm2d).<span class="bu">apply</span>(iw)    <span class="co"># gets the model and applies the init_weights function</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># creates the learner object and passes the model, dataloaders (the data), loss function, learning rate,</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># callbacks and optimizer function</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> TrainLearner(model, dls, F.cross_entropy, lr<span class="op">=</span><span class="fl">6e-3</span>, cbs<span class="op">=</span>cbs, opt_func<span class="op">=</span>Adam)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>learn.fit(<span class="dv">3</span>)                                                <span class="co"># fits the model for 3 epochs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">loss</th>
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.796</td>
<td>0.574</td>
<td>0</td>
<td>train</td>
</tr>
<tr class="even">
<td>0.843</td>
<td>0.433</td>
<td>0</td>
<td>eval</td>
</tr>
<tr class="odd">
<td>0.868</td>
<td>0.363</td>
<td>1</td>
<td>train</td>
</tr>
<tr class="even">
<td>0.867</td>
<td>0.373</td>
<td>1</td>
<td>eval</td>
</tr>
<tr class="odd">
<td>0.884</td>
<td>0.318</td>
<td>2</td>
<td>train</td>
</tr>
<tr class="even">
<td>0.875</td>
<td>0.349</td>
<td>2</td>
<td>eval</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<p><img src="Adam optimizer_files/figure-html/cell-15-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="adam-with-automatic-annealer" class="level1">
<h1>Adam with Automatic Annealer</h1>
<p>Automatic annealing refers to the automatic adjustment of the learning rate during training. Unlike a constant or step-wise decayed learning rate, automatic annealers adjust the learning rate based on the model’s performance, generally on the validation set. Criteria such as validation loss, training loss, or some other metric can be used for this adjustment. <br><br> For instance, if the validation loss plateaus or increases, the annealer may reduce the learning rate, effectively “cooling down” the optimization and allowing the model to escape local minima or saddle points. Conversely, if the model is learning effectively, the annealer might maintain or even slightly increase the learning rate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run with adam with annealing as the optimizer</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdamWithAnnealing(SGD):</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, params, lr, wd<span class="op">=</span><span class="fl">0.</span>, beta1<span class="op">=</span><span class="fl">0.9</span>, beta2<span class="op">=</span><span class="fl">0.99</span>, eps<span class="op">=</span><span class="fl">1e-5</span>, anneal_rate<span class="op">=</span><span class="fl">0.97</span>):</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>(params, lr<span class="op">=</span>lr, wd<span class="op">=</span>wd)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.beta1, <span class="va">self</span>.beta2, <span class="va">self</span>.eps <span class="op">=</span> beta1, beta2, eps</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.anneal_rate <span class="op">=</span> anneal_rate</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> opt_step(<span class="va">self</span>, p):</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(p, <span class="st">'avg'</span>): p.avg <span class="op">=</span> torch.zeros_like(p.grad.data)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(p, <span class="st">'sqr_avg'</span>): p.sqr_avg <span class="op">=</span> torch.zeros_like(p.grad.data)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update averages</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        p.avg <span class="op">=</span> <span class="va">self</span>.beta1 <span class="op">*</span> p.avg <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.beta1) <span class="op">*</span> p.grad</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        unbias_avg <span class="op">=</span> p.avg <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="va">self</span>.beta1<span class="op">**</span>(<span class="va">self</span>.i <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        p.sqr_avg <span class="op">=</span> <span class="va">self</span>.beta2 <span class="op">*</span> p.sqr_avg <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.beta2) <span class="op">*</span> (p.grad<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        unbias_sqr_avg <span class="op">=</span> p.sqr_avg <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="va">self</span>.beta2<span class="op">**</span>(<span class="va">self</span>.i <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Apply annealing to learning rate</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>        annealed_lr <span class="op">=</span> <span class="va">self</span>.lr <span class="op">*</span> (<span class="va">self</span>.anneal_rate <span class="op">**</span> <span class="va">self</span>.i)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update parameters</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        p <span class="op">-=</span> annealed_lr <span class="op">*</span> unbias_avg <span class="op">/</span> (unbias_sqr_avg.sqrt() <span class="op">+</span> <span class="va">self</span>.eps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> MetricsCB(accuracy<span class="op">=</span>MulticlassAccuracy())</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>astats <span class="op">=</span> ActivationStats(fc.risinstance(GeneralRelu))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>cbs <span class="op">=</span> [DeviceCB(), metrics, ProgressCB(plot<span class="op">=</span><span class="va">True</span>), astats]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>act_gr <span class="op">=</span> partial(GeneralRelu, leak<span class="op">=</span><span class="fl">0.1</span>, sub<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>iw <span class="op">=</span> partial(init_weights, leaky<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>lrf_cbs <span class="op">=</span> [DeviceCB(), LRFinderCB()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1704297792565,&quot;user_tz&quot;:0,&quot;elapsed&quot;:104069,&quot;user&quot;:{&quot;displayName&quot;:&quot;alex kelly&quot;,&quot;userId&quot;:&quot;14681700393893986055&quot;}}" data-outputid="00dac5cc-30a2-49af-9508-832bf9929f18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>set_seed(<span class="dv">42</span>)                                               <span class="co"># sets the seed for reproducibility</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> get_model(act_gr, norm<span class="op">=</span>nn.BatchNorm2d).<span class="bu">apply</span>(iw)   <span class="co"># gets the model and applies the init_weights function</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># creates the learner object and passes the model, dataloaders (the data), loss function, learning rate,</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># callbacks and optimizer function</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> TrainLearner(model, dls, F.cross_entropy, lr<span class="op">=</span><span class="fl">6e-3</span>, cbs<span class="op">=</span>cbs, opt_func<span class="op">=</span>AdamWithAnnealing)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>learn.fit(<span class="dv">3</span>)                                               <span class="co"># fits the model for 3 epochs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">loss</th>
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.793</td>
<td>0.580</td>
<td>0</td>
<td>train</td>
</tr>
<tr class="even">
<td>0.835</td>
<td>0.452</td>
<td>0</td>
<td>eval</td>
</tr>
<tr class="odd">
<td>0.854</td>
<td>0.406</td>
<td>1</td>
<td>train</td>
</tr>
<tr class="even">
<td>0.845</td>
<td>0.430</td>
<td>1</td>
<td>eval</td>
</tr>
<tr class="odd">
<td>0.859</td>
<td>0.392</td>
<td>2</td>
<td>train</td>
</tr>
<tr class="even">
<td>0.846</td>
<td>0.427</td>
<td>2</td>
<td>eval</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<p><img src="Adam optimizer_files/figure-html/cell-18-output-3.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="the-calls-backs" class="level1">
<h1>The Calls backs</h1>
<p>To create a call back, i will demostrate it on the simplest of optimizers, the SGD optimizer and repeat the process on the Adam with annealing.</p>
<p>We will create a callbackclass from TrainCB which has the following methods:</p>
<ul>
<li>predict</li>
<li>get_loss</li>
<li>backward</li>
<li>step</li>
<li>zero_grad</li>
</ul>
<p>We will be replacing step, and adding opt_step and reg_step. The step function is called after the backward function and before the zero_grad function. The step function is used to update the model parameters. The opt_step function is used to update the model parameters from the learning rate. The reg_step function is used to update the model parameters from the weight decay if given. The zero_grad function is used to zero the gradients.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SGDCallback_TrainCB(TrainCB):</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, lr, wd<span class="op">=</span><span class="fl">0.</span>, n_inp<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.n_inp <span class="op">=</span> n_inp</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        fc.store_attr()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calculates the parameters and weight decays. Step occurs after the backward pass (when the gradients are calculated)</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>, learn):</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calls torch.no_grad() to disable gradient tracking</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>            <span class="co"># iterates over the parameters</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> p <span class="kw">in</span> learn.model.parameters():</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.reg_step(p)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.opt_step(p)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.i <span class="op">+=</span><span class="dv">1</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Updates the parameters using the gradient and the learning rate</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> opt_step(<span class="va">self</span>, p): p <span class="op">-=</span> p.grad <span class="op">*</span> <span class="va">self</span>.lr</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculates the weight decay and updates the parameters</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The purpose of weight decay is to prevent overfitting. It is calculated by multiplying the learning rate by the weight decay</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># essentially it is a penalty for having large weights (it reduces the value of the weights)</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reg_step(<span class="va">self</span>, p):</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.wd <span class="op">!=</span> <span class="dv">0</span>: p <span class="op">*=</span> <span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.lr<span class="op">*</span><span class="va">self</span>.wd</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> zero_grad(<span class="va">self</span>, learn): learn.opt.zero_grad()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SGDCallback_TrainCB added to callbacks and no optimizer function passed</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> MetricsCB(accuracy<span class="op">=</span>MulticlassAccuracy())</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>astats <span class="op">=</span> ActivationStats(fc.risinstance(GeneralRelu))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>cbs <span class="op">=</span> [DeviceCB(), metrics, ProgressCB(plot<span class="op">=</span><span class="va">True</span>), astats, SGDCallback_TrainCB(lr<span class="op">=</span><span class="fl">6e-3</span>)]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>act_gr <span class="op">=</span> partial(GeneralRelu, leak<span class="op">=</span><span class="fl">0.1</span>, sub<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>iw <span class="op">=</span> partial(init_weights, leaky<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="00ee66b3-60f7-4eef-e4b7-2cd1e90fd640">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training with SGD as the optimizer</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>set_seed(<span class="dv">42</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> get_model(act_gr, norm<span class="op">=</span>nn.BatchNorm2d).<span class="bu">apply</span>(iw)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> Learner(model, dls, F.cross_entropy, cbs<span class="op">=</span>cbs)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>learn.fit(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>method is  &lt;bound method DeviceCB.before_fit of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.before_fit of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method HooksCallback.before_fit of &lt;miniai.activations.ActivationStats object at 0x000002537D6BC910&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.before_fit of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.before_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.before_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.before_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.before_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.before_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.before_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.before_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.before_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.before_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.before_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.backward of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.step of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method SGDCallback_TrainCB.zero_grad of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.before_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.before_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025314BA9EE0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method TrainCB.get_loss of &lt;__main__.SGDCallback_TrainCB object at 0x0000025305198940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_batch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_batch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method MetricsCB.after_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025314B97F10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method ProgressCB.after_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025314384670&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;
method is  &lt;bound method HooksCallback.after_fit of &lt;miniai.activations.ActivationStats object at 0x000002537D6BC910&gt;&gt;
learn in  &lt;__main__.Learner object at 0x0000025446BD2A60&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="0" class="" max="3" style="width:300px; height:20px; vertical-align: middle;"></progress>
      0.00% [0/3 00:00&lt;?]
    </div>
    


    <div>
      <progress value="0" class="" max="59" style="width:300px; height:20px; vertical-align: middle;"></progress>
      0.00% [0/59 00:00&lt;?]
    </div>
    
</div>
<div class="cell-output cell-output-display">
<p><img src="Adam optimizer_files/figure-html/cell-21-output-4.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdamWithAnnealingCallback(TrainCB):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, lr, wd<span class="op">=</span><span class="fl">0.</span>, beta1<span class="op">=</span><span class="fl">0.9</span>, beta2<span class="op">=</span><span class="fl">0.99</span>, eps<span class="op">=</span><span class="fl">1e-5</span>, anneal_rate<span class="op">=</span><span class="fl">0.97</span>, n_inp<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lr, <span class="va">self</span>.wd, <span class="va">self</span>.beta1, <span class="va">self</span>.beta2, <span class="va">self</span>.eps <span class="op">=</span> lr, wd, beta1, beta2, eps</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.anneal_rate <span class="op">=</span> anneal_rate, <span class="va">self</span>.n_inp <span class="op">=</span> n_inp</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> step(<span class="va">self</span>, learn):</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># calls torch.no_grad() to disable gradient tracking</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> torch.no_grad():</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>            <span class="co"># iterates over the parameters</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> p <span class="kw">in</span> learn.model.parameters():</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.reg_step(p)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.opt_step(p)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.i <span class="op">+=</span><span class="dv">1</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> reg_step(<span class="va">self</span>, p):</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>         <span class="cf">if</span> <span class="va">self</span>.wd <span class="op">!=</span> <span class="dv">0</span>: p <span class="op">*=</span> <span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.lr<span class="op">*</span><span class="va">self</span>.wd</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> opt_step(<span class="va">self</span>, p):</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(p, <span class="st">'avg'</span>): <span class="co"># Checks avg tensor doesnt exist in p</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>          p.avg <span class="op">=</span> torch.zeros_like(p.grad.data) <span class="co"># creates a matching size tensor of all parameters to store averages, they will all be zeros.</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(p, <span class="st">'sqr_avg'</span>): <span class="co"># checks sqr_avg doesnt exist in p</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>          p.sqr_avg <span class="op">=</span> torch.zeros_like(p.grad.data)  <span class="co"># creates a matching sized tensor of all parameters to store sqr averages, they will all be zeros.</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># A break down on the formulas for the Adam Optimizer</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># p.avg is to store the averages, it can be thought of as a balance between the old gradients and the new gradiants</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Beta is set between 1 or 0, when its closer to 1 it takes more of the historical gradients into account and when close to 0, it takes the new gradients into account.</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># When its closer to 1, it will be a smoother path and when its zero it will respond to changes in gradients much quicker and appear more erratic.</span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note, on the first run the calculation of p.avg is solely based on the latter part of the equation "(1 - self.beta1) * p.grad".</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># The first part of the equation "self.beta1 * p.avg" is zero meaning due to p.avg being set to zeros in the line "p.avg = torch.zeros_like(p.grad.data)".</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># The next time opt_step is called, The first part of the equation will influence the result "self.beta1 * p.avg".</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>        p.avg <span class="op">=</span> <span class="va">self</span>.beta1 <span class="op">*</span> p.avg <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.beta1) <span class="op">*</span> p.grad</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Unbias_avg purpose is to correct p.avg for the first few times called. Remember that in the previous step, the p.avg is zero so isnt included in the calculations.</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># The unbias will  is more significant for the early iterations and gradually becomes less significant for later iterations.</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>        unbias_avg <span class="op">=</span> p.avg <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="va">self</span>.beta1<span class="op">**</span>(<span class="va">self</span>.i <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Squaring the gradients (p.grad**2) emphasizes larger gradients and diminishes the impact of smaller ones.</span></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>        p.sqr_avg <span class="op">=</span> <span class="va">self</span>.beta2 <span class="op">*</span> p.sqr_avg <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.beta2) <span class="op">*</span> (p.grad<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>        <span class="co"># unbias_sqr_avg purpose is to correct p.sqr_avg for the first few times called. Remember that in the previous step, the p.sqr_avg is zero so isnt included in the calculations.</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># The unbias will  is more significant for the early iterations and gradually becomes less significant for later iterations.</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>        unbias_sqr_avg <span class="op">=</span> p.sqr_avg <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="va">self</span>.beta2<span class="op">**</span>(<span class="va">self</span>.i <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reduces the learning rate with each run by the annealing rate</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>        annealed_lr <span class="op">=</span> <span class="va">self</span>.lr <span class="op">*</span> (<span class="va">self</span>.anneal_rate <span class="op">**</span> <span class="va">self</span>.i)</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Update parameters</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>        p <span class="op">-=</span> annealed_lr <span class="op">*</span> unbias_avg <span class="op">/</span> (unbias_sqr_avg.sqrt() <span class="op">+</span> <span class="va">self</span>.eps)</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculates the weight decay and updates the parameters</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The purpose of weight decay is to prevent overfitting. It is calculated by multiplying the learning rate by the weight decay</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># essentially it is a penalty for having large weights (it reduces the value of the weights)</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> zero_grad(<span class="va">self</span>, learn): learn.opt.zero_grad()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># runs the learning rate finder</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> AdamWithAnnealingCallback(Callback):</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, lr, wd<span class="op">=</span><span class="fl">0.</span>, beta1<span class="op">=</span><span class="fl">0.9</span>, beta2<span class="op">=</span><span class="fl">0.99</span>, eps<span class="op">=</span><span class="fl">1e-5</span>, anneal_rate<span class="op">=</span><span class="fl">0.97</span>):</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lr, <span class="va">self</span>.wd, <span class="va">self</span>.beta1, <span class="va">self</span>.beta2, <span class="va">self</span>.eps <span class="op">=</span> lr, wd, beta1, beta2, eps</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.anneal_rate <span class="op">=</span> anneal_rate</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">        Custom callback class for Adam optimizer with annealing.</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">        Args:</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">        - lr: Learning rate.</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">        - wd: Weight decay (default: 0.).</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">        - beta1: Coefficient for the exponential moving average of the gradient (default: 0.9).</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">        - beta2: Coefficient for the exponential moving average of the squared gradient (default: 0.99).</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">        - eps: Small value added to the denominator for numerical stability (default: 1e-5).</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co">        - anneal_rate: Annealing rate for the learning rate (default: 0.97).</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> before_batch(<span class="va">self</span>):</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co">        Prepare optimizer parameters before each batch.</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co">        This method is called before each batch during training to prepare the optimizer parameters.</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="co">        It initializes the `opt_params` attribute with a list of dictionaries, where each dictionary</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="co">        contains the 'avg' and 'sqr_avg' tensors for the gradients of the model parameters.</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="co">            None</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="va">self</span>.training:</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.opt_params <span class="op">=</span> [{<span class="st">'avg'</span>: torch.zeros_like(p.grad.data), <span class="st">'sqr_avg'</span>: torch.zeros_like(p.grad.data)}</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> <span class="kw">not</span> <span class="bu">hasattr</span>(p, <span class="st">'avg'</span>) <span class="cf">else</span> p.avg <span class="cf">for</span> p <span class="kw">in</span> <span class="va">self</span>.learn.model.parameters()]</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> after_backward(<span class="va">self</span>):</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="co">        Performs the necessary computations and updates the model parameters after the backward pass.</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="co">        This method implements the Adam optimizer update rule for each parameter of the model.</span></span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="co">        Returns:</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="co">            None</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> p, opt_param <span class="kw">in</span> <span class="bu">zip</span>(<span class="va">self</span>.learn.model.parameters(), <span class="va">self</span>.opt_params):</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>            opt_param[<span class="st">'avg'</span>] <span class="op">=</span> <span class="va">self</span>.beta1 <span class="op">*</span> opt_param[<span class="st">'avg'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.beta1) <span class="op">*</span> p.grad</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>            unbias_avg <span class="op">=</span> opt_param[<span class="st">'avg'</span>] <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="va">self</span>.beta1 <span class="op">**</span> (<span class="va">self</span>.n_iter <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>            opt_param[<span class="st">'sqr_avg'</span>] <span class="op">=</span> <span class="va">self</span>.beta2 <span class="op">*</span> opt_param[<span class="st">'sqr_avg'</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> <span class="va">self</span>.beta2) <span class="op">*</span> (p.grad <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>            unbias_sqr_avg <span class="op">=</span> opt_param[<span class="st">'sqr_avg'</span>] <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> (<span class="va">self</span>.beta2 <span class="op">**</span> (<span class="va">self</span>.n_iter <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>            annealed_lr <span class="op">=</span> <span class="va">self</span>.lr <span class="op">*</span> (<span class="va">self</span>.anneal_rate <span class="op">**</span> <span class="va">self</span>.n_iter)</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>            p.data <span class="op">-=</span> annealed_lr <span class="op">*</span> unbias_avg <span class="op">/</span> (unbias_sqr_avg.sqrt() <span class="op">+</span> <span class="va">self</span>.eps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-outputid="15edcceb-ae5b-4315-ff2e-474f73d42bfc">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>metrics <span class="op">=</span> MetricsCB(accuracy<span class="op">=</span>MulticlassAccuracy())</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>astats <span class="op">=</span> ActivationStats(fc.risinstance(GeneralRelu))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>cbs <span class="op">=</span> [DeviceCB(), metrics, ProgressCB(plot<span class="op">=</span><span class="va">True</span>), astats, AdamWithAnnealingCallback(lr<span class="op">=</span><span class="fl">6e-3</span>)]</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>act_gr <span class="op">=</span> partial(GeneralRelu, leak<span class="op">=</span><span class="fl">0.1</span>, sub<span class="op">=</span><span class="fl">0.4</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>iw <span class="op">=</span> partial(init_weights, leaky<span class="op">=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: cannot unpack non-iterable int object</code></pre>
</div>
</div>
<div class="cell" data-outputid="497f630f-9ff2-467a-dc4d-db70e359c579">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training with SGD as the optimizer</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>set_seed(<span class="dv">42</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> get_model(act_gr, norm<span class="op">=</span>nn.BatchNorm2d).<span class="bu">apply</span>(iw)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> Learner(model, dls, F.cross_entropy, cbs<span class="op">=</span>cbs)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>learn.fit(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>method is  &lt;bound method DeviceCB.before_fit of &lt;miniai.learner.DeviceCB object at 0x0000025355822C70&gt;&gt;
learn in  &lt;__main__.Learner object at 0x000002531DB4C1F0&gt;
method is  &lt;bound method MetricsCB.before_fit of &lt;miniai.learner.MetricsCB object at 0x0000025444393C10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x000002531DB4C1F0&gt;
method is  &lt;bound method HooksCallback.before_fit of &lt;miniai.activations.ActivationStats object at 0x0000025355822490&gt;&gt;
learn in  &lt;__main__.Learner object at 0x000002531DB4C1F0&gt;
method is  &lt;bound method ProgressCB.before_fit of &lt;miniai.learner.ProgressCB object at 0x0000025444294940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x000002531DB4C1F0&gt;
method is  &lt;bound method MetricsCB.before_epoch of &lt;miniai.learner.MetricsCB object at 0x0000025444393C10&gt;&gt;
learn in  &lt;__main__.Learner object at 0x000002531DB4C1F0&gt;
method is  &lt;bound method ProgressCB.before_epoch of &lt;miniai.learner.ProgressCB object at 0x0000025444294940&gt;&gt;
learn in  &lt;__main__.Learner object at 0x000002531DB4C1F0&gt;
method is  &lt;bound method DeviceCB.before_batch of &lt;miniai.learner.DeviceCB object at 0x0000025355822C70&gt;&gt;
learn in  &lt;__main__.Learner object at 0x000002531DB4C1F0&gt;
method is  &lt;bound method TrainCB.predict of &lt;__main__.AdamWithAnnealingCallback object at 0x000002531DB012B0&gt;&gt;
learn in  &lt;__main__.Learner object at 0x000002531DB4C1F0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="0" class="" max="3" style="width:300px; height:20px; vertical-align: middle;"></progress>
      0.00% [0/3 00:00&lt;?]
    </div>
    


    <div>
      <progress value="0" class="" max="59" style="width:300px; height:20px; vertical-align: middle;"></progress>
      0.00% [0/59 00:00&lt;?]
    </div>
    
</div>
<div class="cell-output cell-output-error">
<pre><code>AttributeError: 'AdamWithAnnealingCallback' object has no attribute 'n_inp'</code></pre>
</div>
</div>
<div class="cell" data-outputid="be1d38ab-cbc8-4b92-bdb9-5a11d7d63cdf">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>Sequential(
  (0): Sequential(
    (0): Conv2d(1, 8, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (1): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): GeneralRelu()
  )
  (1): Sequential(
    (0): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): GeneralRelu()
  )
  (2): Sequential(
    (0): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): GeneralRelu()
  )
  (3): Sequential(
    (0): Conv2d(32, 64, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
    (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): GeneralRelu()
  )
  (4): Sequential(
    (0): Conv2d(64, 10, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  )
  (5): Flatten(start_dim=1, end_dim=-1)
)</code></pre>
</div>
</div>
<div class="cell" data-outputid="d1bc75e7-4ed0-401a-a355-9b9709182e3d">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Training with SGD as the optimizer</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>set_seed(<span class="dv">42</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> get_model(act_gr, norm<span class="op">=</span>nn.BatchNorm2d).<span class="bu">apply</span>(iw)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>learn <span class="op">=</span> TrainLearner(model, dls, F.cross_entropy, lr<span class="op">=</span><span class="fl">6e-3</span>, cbs<span class="op">=</span>cbs, opt_func<span class="op">=</span>AdamWithAnnealing)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>learn.fit(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="0" class="" max="3" style="width:300px; height:20px; vertical-align: middle;"></progress>
      0.00% [0/3 00:00&lt;?]
    </div>
    


    <div>
      <progress value="0" class="" max="59" style="width:300px; height:20px; vertical-align: middle;"></progress>
      0.00% [0/59 00:00&lt;?]
    </div>
    
</div>
<div class="cell-output cell-output-error">
<pre><code>AttributeError: learn</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script type="application/vnd.jupyter.widget-state+json">
{"76edd4ce9e8c4dbf816f5ad5562a93d0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_636425585071494b9097d5a3567b6008","IPY_MODEL_3b496ef65abf4191b309173290706623","IPY_MODEL_2f3d802b675d427c82e67f81014258b2"],"layout":"IPY_MODEL_bb30ebe8a5b347a88f7e7ba1bf52ebe6"}},"636425585071494b9097d5a3567b6008":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c9446fe551504aaca206678147bbb566","placeholder":"​","style":"IPY_MODEL_4e914d31f36e464a8a79861d3527ac4d","value":"Downloading data: 100%"}},"3b496ef65abf4191b309173290706623":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f67761e1d16e482db7f13475367b9764","max":30931277,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4e93dda210714f35bcb57ef29b9c701a","value":30931277}},"2f3d802b675d427c82e67f81014258b2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b4b8f6bc390d437fbac53deae7034098","placeholder":"​","style":"IPY_MODEL_09198c4d27864ac3a6da3b29d8edd409","value":" 30.9M/30.9M [00:22&lt;00:00, 1.44MB/s]"}},"bb30ebe8a5b347a88f7e7ba1bf52ebe6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c9446fe551504aaca206678147bbb566":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4e914d31f36e464a8a79861d3527ac4d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f67761e1d16e482db7f13475367b9764":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4e93dda210714f35bcb57ef29b9c701a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b4b8f6bc390d437fbac53deae7034098":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"09198c4d27864ac3a6da3b29d8edd409":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d735656a7a394c939c199b9f5b251081":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e5ee4256fc6c42dfafa6c073e4d1f827","IPY_MODEL_8278d1fb918c445599f1c91e9e41b7a1","IPY_MODEL_2f8fb5da7ae247f4b0d3d523567bb858"],"layout":"IPY_MODEL_16a4a704a376465e92d0c391329411ee"}},"e5ee4256fc6c42dfafa6c073e4d1f827":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8ab348f73d22434e882a0d792103e396","placeholder":"​","style":"IPY_MODEL_73db7f93bbae4950892c353e424b8bc1","value":"Downloading data: 100%"}},"8278d1fb918c445599f1c91e9e41b7a1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b07fde7d85b34aaa843b796f3494ee58","max":5175617,"min":0,"orientation":"horizontal","style":"IPY_MODEL_25605b7d32aa4343b761b4ecb6310242","value":5175617}},"2f8fb5da7ae247f4b0d3d523567bb858":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5b0a4e3fca5246c28aaf750c1d8206d0","placeholder":"​","style":"IPY_MODEL_5ac7bac70b814eb283f91eaa3484f1e1","value":" 5.18M/5.18M [00:02&lt;00:00, 1.72MB/s]"}},"16a4a704a376465e92d0c391329411ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8ab348f73d22434e882a0d792103e396":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"73db7f93bbae4950892c353e424b8bc1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b07fde7d85b34aaa843b796f3494ee58":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"25605b7d32aa4343b761b4ecb6310242":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5b0a4e3fca5246c28aaf750c1d8206d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5ac7bac70b814eb283f91eaa3484f1e1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f52b048abd99419b92214941f55798bd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dbdc9c6cd7c843bf97dcc0cb8c631624","IPY_MODEL_2594f32fc68e4dfcb6a4fc7ad142c285","IPY_MODEL_7302eb79757f47088d229fb6c82899ab"],"layout":"IPY_MODEL_e530dc800dd74134a8f149dce4a7c1d2"}},"dbdc9c6cd7c843bf97dcc0cb8c631624":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b67000ea22614a2b91a190f0d26e914e","placeholder":"​","style":"IPY_MODEL_1593efa05ca6495d9df475cff513fd00","value":"Generating train split: "}},"2594f32fc68e4dfcb6a4fc7ad142c285":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d4a3e97d89ec4be9a7b4b2633acd029a","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ff3a814817534ebdb0ee0ee576505f6b","value":1}},"7302eb79757f47088d229fb6c82899ab":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_372c1370a8464c1b8f34b2c79b2b2f31","placeholder":"​","style":"IPY_MODEL_db158860365745c4a6836d6cccbefb0f","value":" 60000/0 [00:00&lt;00:00, 274534.51 examples/s]"}},"e530dc800dd74134a8f149dce4a7c1d2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b67000ea22614a2b91a190f0d26e914e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1593efa05ca6495d9df475cff513fd00":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d4a3e97d89ec4be9a7b4b2633acd029a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"ff3a814817534ebdb0ee0ee576505f6b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"372c1370a8464c1b8f34b2c79b2b2f31":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"db158860365745c4a6836d6cccbefb0f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"08b7c8dd16fa4d669d72a8867eb63f27":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_475058126dbc45ab966b73238b30d175","IPY_MODEL_eee340e1766e429fbeba5e003c4a4a14","IPY_MODEL_c4aaed2653684ca3bf4d7ad3f1ad2eb8"],"layout":"IPY_MODEL_fc98c842720c4695925c75a4cc54faac"}},"475058126dbc45ab966b73238b30d175":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9b05d3ceab22435c93d634c6d261fe1f","placeholder":"​","style":"IPY_MODEL_95c3ab98df4b4da9aa23bb13a1a276c9","value":"Generating test split: "}},"eee340e1766e429fbeba5e003c4a4a14":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4cec877b59a148da821044cc42e44b09","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_113d105277924f9b80cff935534028e4","value":1}},"c4aaed2653684ca3bf4d7ad3f1ad2eb8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9671e911f3214ba89b99b6896ca74cd4","placeholder":"​","style":"IPY_MODEL_f371ee5c6e1f4704bebba000f421f5d4","value":" 10000/0 [00:00&lt;00:00, 154143.98 examples/s]"}},"fc98c842720c4695925c75a4cc54faac":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9b05d3ceab22435c93d634c6d261fe1f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"95c3ab98df4b4da9aa23bb13a1a276c9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4cec877b59a148da821044cc42e44b09":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"113d105277924f9b80cff935534028e4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9671e911f3214ba89b99b6896ca74cd4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f371ee5c6e1f4704bebba000f421f5d4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>